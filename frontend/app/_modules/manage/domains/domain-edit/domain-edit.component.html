<section class="container">
    <!-- Heading -->
    <h1 *ngIf="isNew"  i18n="heading">Create domain</h1>
    <h1 *ngIf="!isNew" i18n="heading">Edit domain</h1>

    <!-- Edit form -->
    <form [formGroup]="form" [appSpinner]="loading.active" (ngSubmit)="submit()" (keydown.control.enter)="submit()" spinnerSize="lg">
        <!-- Info -->
        <div *ngIf="isNew" class="mb-3">
            <ng-container i18n>Add a domain to enable comments on it.</ng-container>
        </div>
        <!-- Host -->
        <div class="mb-3 row">
            <label for="host" class="col-sm-3 col-form-label colon" i18n>Host</label>
            <div class="col-sm-9">
                <input formControlName="host" type="text" class="form-control" id="host"
                       [class.is-valid]="isNew && host.touched && host.valid"
                       [class.is-invalid]="isNew && host.touched && host.invalid"
                       required minlength="1" maxlength="253" placeholder="example.com">
                <!-- Invalid feedback -->
                <div class="invalid-feedback">
                    <ng-container i18n>Please enter a valid domain host.</ng-container>
                </div>
                <small *ngIf="isNew" id="nameHelpBlock" class="form-text text-muted">
                    <fa-icon [icon]="faExclamationTriangle" class="me-1"></fa-icon>
                    <ng-container i18n>You won't be able to change the host once domain is created.</ng-container>
                </small>
            </div>
        </div>
        <!-- Display name -->
        <div class="mb-3 row">
            <label for="displayName" class="col-sm-3 col-form-label colon" i18n>Display name</label>
            <div class="col-sm-9">
                <input formControlName="displayName" type="text" class="form-control" id="displayName"
                       [class.is-valid]="displayName.touched && displayName.valid"
                       [class.is-invalid]="displayName.touched && displayName.invalid"
                       maxlength="255">
                <div class="invalid-feedback" i18n>Value is too long.</div>
            </div>
        </div>

        <!-- Comment moderation -->
        <div class="mb-3 row">
            <div class="offset-sm-3 col-sm-9">
                <!-- Subheading -->
                <div class="fw-bold mt-3 mb-1" i18n>Comment moderation</div>

                <!-- Automatic spam filtering -->
                <div class="form-check me-3">
                    <input formControlName="autoSpamFilter" type="checkbox" class="form-check-input" id="autoSpamFilter">
                    <label class="form-check-label" for="autoSpamFilter" i18n>Automatic spam filtering</label>
                </div>
                <!-- Require all comments to be approved manually -->
                <div class="form-check me-3">
                    <input formControlName="requireModeration" type="checkbox" class="form-check-input" id="requireModeration">
                    <label class="form-check-label" for="requireModeration" i18n>Require all comments to be approved manually</label>
                </div>
                <!-- Require anonymous comments to be approved manually -->
                <div class="form-check me-3">
                    <input formControlName="moderateAllAnonymous" type="checkbox" class="form-check-input" id="moderateAllAnonymous">
                    <label class="form-check-label" for="moderateAllAnonymous" i18n>Require anonymous comments to be approved manually</label>
                </div>
            </div>
        </div>

        <!-- Comment sorting -->
        <div class="mb-3 row">
            <div class="offset-sm-3 col-sm-9">
                <!-- Subheading -->
                <div class="fw-bold mt-3 mb-1" i18n>Comment sorting</div>

                <!-- Most upvoted first -->
                <div class="form-check">
                    <input formControlName="defaultSortPolicy" class="form-check-input" type="radio"
                           id="sortUpvoted" value="score-desc">
                    <label class="form-check-label" for="sortUpvoted" i18n>Most upvoted first</label>
                </div>
                <!-- Newest first -->
                <div class="form-check">
                    <input formControlName="defaultSortPolicy" class="form-check-input" type="radio"
                           id="sortNewest" value="creationdate-desc">
                    <label class="form-check-label" for="sortNewest" i18n>Newest first</label>
                </div>
                <!-- Oldest first -->
                <div class="form-check">
                    <input formControlName="defaultSortPolicy" class="form-check-input" type="radio"
                           id="sortOldest" value="creationdate-asc">
                    <label class="form-check-label" for="sortOldest" i18n>Oldest first</label>
                </div>
            </div>
        </div>

        <!-- Email moderators -->
        <div class="mb-3 row">
            <div class="offset-sm-3 col-sm-9">
                <!-- Subheading -->
                <div class="fw-bold mt-3 mb-1" i18n>Email moderators</div>

                <!-- Don't email -->
                <div class="form-check">
                    <input formControlName="emailNotificationPolicy" class="form-check-input" type="radio"
                           id="emailPolicyNone" value="none">
                    <label class="form-check-label" for="emailPolicyNone" i18n>Don't email</label>
                </div>
                <!-- Only for comments pending moderation -->
                <div class="form-check">
                    <input formControlName="emailNotificationPolicy" class="form-check-input" type="radio"
                           id="emailPolicyPendingModeration" value="pending-moderation">
                    <label class="form-check-label" for="emailPolicyPendingModeration" i18n>Only for comments pending moderation</label>
                </div>
                <!-- For every new comment -->
                <div class="form-check">
                    <input formControlName="emailNotificationPolicy" class="form-check-input" type="radio"
                           id="emailPolicyAll" value="all">
                    <label class="form-check-label" for="emailPolicyAll" i18n>For every new comment</label>
                </div>
            </div>
        </div>

        <!-- Authentication -->
        <div class="mb-3 row">
            <div class="offset-sm-3 col-sm-9">
                <!-- Subheading -->
                <div class="fw-bold mt-3 mb-1" i18n>Authentication</div>

                <!-- Anonymous comments -->
                <div class="form-check me-3">
                    <input formControlName="allowAnonymous" type="checkbox" class="form-check-input" id="authAnonymous">
                    <label class="form-check-label" for="authAnonymous" i18n>Anonymous comments</label>
                </div>

                <!-- Identity providers -->
                <div formArrayName="idps">
                    <div *ngFor="let idp of idps; index as idx" class="form-check me-3">
                        <input [formControlName]="idx" type="checkbox" class="form-check-input" [id]="'auth-' + idp.id">
                        <label class="form-check-label" [for]="'auth-' + idp.id">{{ idp.name }}</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Buttons -->
        <div class="form-footer">
            <a routerLink=".." class="btn btn-link" i18n="action">Cancel</a>
            <button [appSpinner]="saving.active" type="submit" class="btn btn-primary">
                <ng-container *ngIf="isNew"  i18n="action">Create</ng-container>
                <ng-container *ngIf="!isNew" i18n="action">Save</ng-container>
            </button>
        </div>
    </form>
</section>
