<div class="d-block d-md-flex">
    <!-- Dark background underneath the normal (not fixed/sticky) sidebar that covers a possible gap between the real
         sidebar and the footer. Relevant when the screen is taller than the sidebar, since the footer will be at the
         screen's bottom. -->
    <div class="cc-sidebar-filler"></div>

    <!-- Sidebar outer container, either normal (wide screen) or fixed -->
    <nav id="sidebarMenu" class="cc-sidebar-container" [class.expanded]="expanded">
        <!-- Sidebar content, either sticky (wide screen) or scrollable -->
        <div class="sidebar-content">
            <!-- Logo -->
            <div class="cc-logo">
                <a [routerLink]="Paths.home" role="button">
                    <img src="images/logo.svg" width="192" height="48" class="cc-logo-expanded" alt="Comentario">
                    <img src="images/icon.svg" width="32" height="32" class="cc-logo-collapsed" alt="Comentario">
                </a>
            </div>

            <!-- Regular user's items -->
            <ul class="nav">
                <!-- Show/collapse button -->
                <li class="nav-item d-md-none mw-100">
                    <a [class.collapsed]="!expanded" [attr.aria-expanded]="expanded"
                       (click)="toggleExpanded()" (keydown.enter)="toggleExpanded()"
                       class="cc-toggler collapse-toggler" role="button" tabindex="0" id="sidebarToggler">
                        <fa-icon class="cc-icon" [icon]="faChevronRight"></fa-icon>
                    </a>
                </li>

                <!-- Dashboard -->
                <li class="nav-item">
                    <a [routerLink]="Paths.manage.dashboard" routerLinkActive="active" class="cc-link">
                        <fa-icon class="cc-icon" [icon]="faTachometerAlt"></fa-icon>
                        <span class="cc-hide-collapsed" i18n>Dashboard</span>
                    </a>
                </li>

                <!-- Domain items: only when there's a domain selected -->
                <ng-container *ngIf="domain | async as d else noDomain">
                    <!-- Properties -->
                    <li class="nav-item">
                        <a [routerLink]="[Paths.manage.domains, d.id]" routerLinkActive="active" class="cc-link">
                            <fa-icon class="cc-icon" [icon]="faAt"></fa-icon>
                            <div class="cc-hide-collapsed overflow-hidden">
                                <div class="colon" i18n>Domain</div>
                                <div class="cc-vshrink-collapsed text-truncate">{{ d.name || d.host }}</div>
                            </div>
                        </a>
                    </li>
                    <!-- Comments -->
                    <li class="nav-item">
                        <a [routerLink]="Paths.manage.comments" routerLinkActive="active" class="cc-link">
                            <fa-icon class="cc-icon" [icon]="faComments"></fa-icon>
                            <div class="cc-hide-collapsed" i18n>Comments</div>
                        </a>
                    </li>
                    <!-- Users -->
                    <li class="nav-item">
                        <a [routerLink]="Paths.manage.users" routerLinkActive="active" class="cc-link">
                            <fa-icon class="cc-icon" [icon]="faUsers"></fa-icon>
                            <div class="cc-hide-collapsed" i18n>Users</div>
                        </a>
                    </li>
                    <!-- Stats -->
                    <li class="nav-item">
                        <a [routerLink]="Paths.manage.stats" routerLinkActive="active" class="cc-link">
                            <fa-icon class="cc-icon" [icon]="faChartLine"></fa-icon>
                            <div class="cc-hide-collapsed" i18n>Statistics</div>
                        </a>
                    </li>
                    <!-- Operations -->
                    <li class="nav-item">
                        <a [routerLink]="Paths.manage.operations" routerLinkActive="active" class="cc-link">
                            <fa-icon class="cc-icon" [icon]="faArrowDownUpAcrossLine"></fa-icon>
                            <div class="cc-hide-collapsed" i18n>Operations</div>
                        </a>
                    </li>
                </ng-container>

                <!-- Domain selector when there's no domain -->
                <ng-template #noDomain>
                    <li class="nav-item">
                        <a [routerLink]="Paths.manage.domains" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="cc-link">
                            <fa-icon class="cc-icon" [icon]="faAt"></fa-icon>
                            <div class="cc-hide-collapsed" i18n>Domains</div>
                        </a>
                    </li>
                </ng-template>

                <!-- [Account] -->
                <li class="nav-item cc-divider">
                    <h2 class="cc-hide-collapsed" i18n>Account</h2>
                </li>
                <!-- Profile -->
                <li class="nav-item">
                    <a [routerLink]="Paths.manage.account.profile" routerLinkActive="active" class="cc-link" id="sidebarProfile">
                        <!-- User's avatar -->
                        <fa-icon class="cc-icon" [icon]="faUser"></fa-icon>
                        <div class="cc-hide-collapsed">
                            <!-- User's name -->
                            <div class="text-truncate" style="max-width: 200px">{{ principal?.name }}</div>
                        </div>
                    </a>
                </li>
            </ul>

            <!-- Logout -->
            <ul class="nav">
                <li class="nav-item cc-divider">
                    <h2 class="cc-hide-collapsed" i18n>Logout</h2>
                </li>
                <li class="nav-item">
                    <a appConfirm="Are you sure you want to logout?" confirmAction="Logout" [confirmIcon]="faQuestionCircle"
                       (confirmed)="logout()" role="button" class="cc-link" i18n-appConfirm i18n-confirmAction>
                        <fa-icon class="cc-icon" [icon]="faSignOutAlt"></fa-icon>
                        <span class="cc-hide-collapsed" i18n>Logout</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Sidebar backdrop, only on a small screen and when the sidebar is expanded -->
    <div [class.show]="expanded" (click)="toggleExpanded()" (keydown.enter)="toggleExpanded()"
         class="cc-backdrop" tabindex="-1"></div>

    <!-- Main page content -->
    <div class="cc-content">
        <router-outlet></router-outlet>
    </div>
</div>
